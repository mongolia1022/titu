/**
 * @author 一滴水 qq:348681066
 */
function displayYorN(curdir,nextid,curid,curclass,isAll){$("."+curclass).removeClass('seleted');if($("dl").find("#"+nextid).css('display')=='none'){if($("#"+nextid).html().length==0){if(isAll==true){getCurDirTree(curdir,nextid)}else{getCurDirs(curdir,nextid)}}else{$("dl").find("#"+nextid).slideDown("slow")};$("dl").find("#"+curid).addClass('seleted')}else{$("dl").find("#"+nextid).slideUp("slow");$("dl").find("#"+curid).removeClass('seleted')}};function getCurDirTree(curdir,nextid){var url=moptions.sUrl.getCurDirTree+'&curdir='+curdir;var code='$("#'+nextid+'").empty();';code+='$(messageArr[1]).appendTo("#'+nextid+'");';code+='$("dl").find("#'+nextid+'").slideDown("slow");';AjaxGet(url,1,code)};function getCurDirs(curdir,nextid){var url=moptions.sUrl.getCurDirs+'&curdir='+curdir;var code='$("#'+nextid+'").empty();';code+='$(messageArr[1]).appendTo("#'+nextid+'");';code+='$("dl").find("#'+nextid+'").slideDown("slow");';AjaxGet(url,1,code)};function getFileCode(file,curid,curclass){var url=moptions.sUrl.getFileCode+'&'+moptions.inputId.fileName+'='+file;var code='$("#'+moptions.inputId.fileName+'").attr("value","'+file+'");';code+='$(".'+curclass+'").removeClass("seleted");';code+='$("#'+curid+'").addClass("seleted");';code+='setNewMode("'+file+'");';code+='codeEditor.setValue(messageArr[1]);';AjaxGet(url,1,code)};function saveFileCode(){var url=moptions.sUrl.saveFileCode;var data='&'+moptions.inputId.fileName+'='+$("#"+moptions.inputId.fileName).val()+'&'+moptions.inputId.fileCode+'='+codeEditor.getValue().replace(/&/g,"{##}").replace(/\+/g,"{####}");var code='setTimeout("reSetHandle(false)",2000);';AjaxPost(url,data,0,code)};function getCmdCode(){var scmd=$("#scmd").val();var stype=$("#stype").val().toLowerCase();var sid=$("#sid").val();var code="";if(scmd.indexOf("create")!="-1"){var nextid=$("#"+sid).parent().parent().parent().attr("id");if(stype=="dir")nextid="next_"+sid;code+='getCurDirTree("'+$("#dirPath").val()+'","'+nextid+'");'}else if(scmd.indexOf("update")!="-1"){var nextid=$("#"+sid).parent().parent().parent().attr("id");if(stype=="dir")nextid="next_"+sid;code+='getCurDirTree("'+$("#dirPath").val()+'","'+nextid+'");'}else if(scmd.indexOf("reName")!="-1"){if(stype=="file"){var newNmae=$("#newName").val();var ext1=getExt(newNmae);var ext2=getExt($("#dirPath").val());if(ext1!=ext2){newNmae+=ext2}}else{var nextid="next_"+sid;var newNmae=$("#newFolder").val();code+='getCurDirTree("'+$("#spath").val()+newNmae+'","'+nextid+'");'};code+='$("#'+sid+'").attr("href","'+$("#spath").val()+newNmae+'");';code+='$("#'+sid+'").html("'+newNmae+'");'}else if(scmd.indexOf("delete")!="-1"){if(stype=="dir"){code+='$("#next_'+sid+'").remove();'};code+='$("#'+sid+'").parent().remove();'}else if(scmd.indexOf("move")!="-1"){var newFolder=$("#newFolder").val();var nextid=$("a[href='"+newFolder+"']").attr("child");if(stype=="dir"){code+='$("#next_'+sid+'").remove();'};code+='$("#'+sid+'").parent().remove();';code+='getCurDirTree("'+newFolder+'","'+nextid+'");';}else{};code+='closeWindow();';return code};function createDir(){var url=getUrl(moptions.sUrl.createDir);if(url)AjaxGet(url,1,getCmdCode())};function createPHPFile(){var url=getUrl(moptions.sUrl.createPHPFile);if(url)AjaxGet(url,1,getCmdCode())};function createJSFile(){var url=getUrl(moptions.sUrl.createJSFile);if(url)AjaxGet(url,1,getCmdCode())};function createCSSFile(){var url=getUrl(moptions.sUrl.createCSSFile);if(url)AjaxGet(url,1,getCmdCode())};function createXMLFile(){var url=getUrl(moptions.sUrl.createXMLFile);if(url)AjaxGet(url,1,getCmdCode())};function createHTMLFile(){var url=getUrl(moptions.sUrl.createHTMLFile);if(url)AjaxGet(url,1,getCmdCode())};function reNameFile(){var url=getUrl(moptions.sUrl.reNameFile);if(url)AjaxGet(url,1,getCmdCode())};function reNameDir(){var url=getUrl(moptions.sUrl.reNameDir);if(url)AjaxGet(url,1,getCmdCode())};function moveFile(){var url=getUrl(moptions.sUrl.moveFile);if(url)AjaxGet(url,1,getCmdCode())};function moveDir(){var url=getUrl(moptions.sUrl.moveDir);if(url)AjaxGet(url,1,getCmdCode())};function deleteFile(){var url=getUrl(moptions.sUrl.deleteFile);if(url)AjaxGet(url,1,getCmdCode())};function deleteDir(){var url=getUrl(moptions.sUrl.deleteDir);if(url)AjaxGet(url,1,getCmdCode())};function getUrl(url){var url;var tmp=new Array();tmp=moptions.inputId;for(var x in tmp){if(x!=moptions.inputId.fileName&&x!=moptions.inputId.fileCode){var v=$("#"+x).val();if(typeof v!="undefined"){if(valiDatas(v)){url+='&'+x+'='+v}else{return false}}}};return url};function AjaxGet(url,mode,code){var url,mode,code;$.ajax({type:"GET",url:url,cache:false,success:function(html){message(mode,html,code)}})};function AjaxPost(url,data,mode,code){var url,data,mode,code;$.ajax({type:"POST",url:url,cache:false,data:data,success:function(html){message(mode,html,code)}})};function message(mode,message,code){var mode,message,code;switch(mode){case 0:alert(message);if(code.length>0)eval(code);break;case 1:var messageArr=message.split('::');if(messageArr[0]==1){if(code.length>0)eval(code);else alert(messageArr[1])}else{alert(messageArr[1])};break;default:alert(message);break}}